(function(){var t,e,a,n,i,s=[].indexOf||function(t){for(var e=0,a=this.length;a>e;e++)if(e in this&&this[e]===t)return e;return-1};i="undefined"!=typeof exports&&null!==exports?exports:this,t=["pilots","upgrades","modifications","titles"],e={pilots:"Pilot",modifications:"Modification",titles:"Title"},a=function(t,e){var a,n;return a=t.name.toLowerCase().replace(/[^a-zA-Z0-9]/g,""),n=e.name.toLowerCase().replace(/[^a-zA-Z0-9]/g,""),n>a?-1:a>n?1:0},n=function(t,e){return t.data.points<e.data.points?-1:e.data.points<t.data.points?1:a(t,e)},String.prototype.capitalize=function(){return this.charAt(0).toUpperCase()+this.slice(1)},i.CardBrowser=function(){function o(t){this.container=$(t.container),this.currently_selected=null,this.prepareData(),this.setupUI(),this.setupHandlers(),this.sort_selector.change()}return o.prototype.setupUI=function(){return this.container.append($.trim('<div class="container-fluid xwing-card-browser">\n    <div class="row-fluid">\n        <div class="span12">\n            Sort cards by: <select class="sort-by">\n                <option value="name">Name</option>\n                <option value="source">Source</option>\n                <option value="type-by-points">Type (by Points)</option>\n                <option value="type-by-name" selected="1">Type (by Name)</option>\n            </select>\n        </div>\n    </div>\n    <div class="row-fluid">\n        <div class="span4 card-selector-container">\n\n        </div>\n        <div class="span8">\n            <div class="well card-viewer-placeholder info-well">\n                <p>Select a card from the list at the left.</p>\n            </div>\n            <div class="well card-viewer-container info-well">\n                <span class="info-name"></span>\n                <br />\n                <span class="info-type"></span>\n                <br />\n                <span class="info-sources"></span>\n                <table>\n                    <tbody>\n                        <tr class="info-skill">\n                            <td>Skill</td>\n                            <td class="info-data info-skill"></td>\n                        </tr>\n                        <tr class="info-attack">\n                            <td><img class="icon-attack" src="images/transparent.png" alt="Attack" /></td>\n                            <td class="info-data info-attack"></td>\n                        </tr>\n                        <tr class="info-range">\n                            <td>Range</td>\n                            <td class="info-data info-range"></td>\n                        </tr>\n                        <tr class="info-agility">\n                            <td><img class="icon-agility" src="images/transparent.png" alt="Agility" /></td>\n                            <td class="info-data info-agility"></td>\n                        </tr>\n                        <tr class="info-hull">\n                            <td><img class="icon-hull" src="images/transparent.png" alt="Hull" /></td>\n                            <td class="info-data info-hull"></td>\n                        </tr>\n                        <tr class="info-shields">\n                            <td><img class="icon-shields" src="images/transparent.png" alt="Shields" /></td>\n                            <td class="info-data info-shields"></td>\n                        </tr>\n                        <tr class="info-actions">\n                            <td>Actions</td>\n                            <td class="info-data"></td>\n                        </tr>\n                        <tr class="info-upgrades">\n                            <td>Upgrades</td>\n                            <td class="info-data"></td>\n                        </tr>\n                    </tbody>\n                </table>\n                <p class="info-text" />\n            </div>\n        </div>\n    </div>\n</div>')),this.card_selector_container=$(this.container.find(".xwing-card-browser .card-selector-container")),this.card_viewer_container=$(this.container.find(".xwing-card-browser .card-viewer-container")),this.card_viewer_container.hide(),this.card_viewer_placeholder=$(this.container.find(".xwing-card-browser .card-viewer-placeholder")),this.sort_selector=$(this.container.find("select.sort-by")),this.sort_selector.select2({minimumResultsForSearch:-1})},o.prototype.setupHandlers=function(){var t=this;return this.sort_selector.change(function(){return t.renderList(t.sort_selector.val())})},o.prototype.prepareData=function(){var o,d,r,l,c,u,h,p,_,m,f,v,b,g,w,y,$,k,q,x,C,A,D,S,I;for(this.all_cards=[],u=0,m=t.length;m>u;u++)c=t[u],this.all_cards="upgrades"===c?this.all_cards.concat(function(){var t,e;t=i[c],e=[];for(r in t)d=t[r],e.push({name:r,type:""+d.slot+" Upgrade",data:d});return e}()):this.all_cards.concat(function(){var t,a;t=i[c],a=[];for(r in t)d=t[r],a.push({name:r,type:e[c],data:d});return a}());this.types=["Pilot","Modification","Title"],k=i.upgrades;for(r in k)d=k[r],q=""+d.slot+" Upgrade",0>s.call(this.types,q)&&this.types.push(""+d.slot+" Upgrade");for(this.all_cards.sort(a),this.sources=[],x=this.all_cards,h=0,f=x.length;f>h;h++)for(o=x[h],C=o.data.sources,p=0,v=C.length;v>p;p++)l=C[p],0>s.call(this.sources,l)&&this.sources.push(l);for(this.cards_by_type_name={},A=this.types.sort(),_=0,b=A.length;b>_;_++)c=A[_],this.cards_by_type_name[c]=function(){var t,e,a,n;for(a=this.all_cards,n=[],e=0,t=a.length;t>e;e++)o=a[e],o.type===c&&n.push(o);return n}.call(this).sort(a);for(this.cards_by_type_points={},D=this.types.sort(),y=0,g=D.length;g>y;y++)c=D[y],this.cards_by_type_points[c]=function(){var t,e,a,n;for(a=this.all_cards,n=[],e=0,t=a.length;t>e;e++)o=a[e],o.type===c&&n.push(o);return n}.call(this).sort(n);for(this.cards_by_source={},S=this.sources,I=[],$=0,w=S.length;w>$;$++)l=S[$],I.push(this.cards_by_source[l]=function(){var t,e,a,n;for(a=this.all_cards,n=[],e=0,t=a.length;t>e;e++)o=a[e],s.call(o.data.sources,l)>=0&&n.push(o);return n}.call(this).sort(a));return I},o.prototype.renderList=function(t){var e,a,n,i,s,o,d,r,l,c,u,h,p,_,m,f,v,b,g,w,y,k,q,x,C,A=this;switch(null==t&&(t="name"),null!=this.card_selector&&this.card_selector.remove(),this.card_selector=$(document.createElement("SELECT")),this.card_selector.addClass("card-selector"),this.card_selector.attr("size",25),this.card_selector_container.append(this.card_selector),t){case"type-by-name":for(g=this.types,s=0,l=g.length;l>s;s++)for(i=g[s],a=$(document.createElement("OPTGROUP")),a.attr("label",i),this.card_selector.append(a),w=this.cards_by_type_name[i],o=0,c=w.length;c>o;o++)e=w[o],this.addCardTo(a,e);break;case"type-by-points":for(y=this.types,d=0,u=y.length;u>d;d++)for(i=y[d],a=$(document.createElement("OPTGROUP")),a.attr("label",i),this.card_selector.append(a),k=this.cards_by_type_points[i],r=0,h=k.length;h>r;r++)e=k[r],this.addCardTo(a,e);break;case"source":for(q=this.sources,f=0,p=q.length;p>f;f++)for(n=q[f],a=$(document.createElement("OPTGROUP")),a.attr("label",n),this.card_selector.append(a),x=this.cards_by_source[n],v=0,_=x.length;_>v;v++)e=x[v],this.addCardTo(a,e);break;default:for(C=this.all_cards,b=0,m=C.length;m>b;b++)e=C[b],this.addCardTo(this.card_selector,e)}return this.card_selector.change(function(){return A.renderCard($(A.card_selector.find(":selected")))})},o.prototype.renderCard=function(t){var e,a,n,s,o,d,r,l,c,u,h,p,_;switch(a=t.data("name"),s=t.data("type"),e=t.data("card"),this.card_viewer_container.find(".info-name").html(""+(e.unique?"&middot;&nbsp;":"")+a+" ("+e.points+")"),this.card_viewer_container.find("p.info-text").html(null!=(o=e.text)?o:""),this.card_viewer_container.find(".info-sources").text(e.sources.sort().join(", ")),s){case"Pilot":n=i.ships[e.ship],this.card_viewer_container.find(".info-type").text(""+e.ship+" Pilot ("+n.faction+")"),this.card_viewer_container.find("tr.info-skill td.info-data").text(e.skill),this.card_viewer_container.find("tr.info-skill").show(),this.card_viewer_container.find("tr.info-attack td.info-data").text(null!=(d=null!=(r=e.ship_override)?r.attack:void 0)?d:n.attack),this.card_viewer_container.find("tr.info-attack").show(),this.card_viewer_container.find("tr.info-range").hide(),this.card_viewer_container.find("tr.info-agility td.info-data").text(null!=(l=null!=(c=e.ship_override)?c.agility:void 0)?l:n.agility),this.card_viewer_container.find("tr.info-agility").show(),this.card_viewer_container.find("tr.info-hull td.info-data").text(null!=(u=null!=(h=e.ship_override)?h.hull:void 0)?u:n.hull),this.card_viewer_container.find("tr.info-hull").show(),this.card_viewer_container.find("tr.info-shields td.info-data").text(null!=(p=null!=(_=e.ship_override)?_.shields:void 0)?p:n.shields),this.card_viewer_container.find("tr.info-shields").show(),this.card_viewer_container.find("tr.info-actions td.info-data").text(i.ships[e.ship].actions.join(", ")),this.card_viewer_container.find("tr.info-actions").show(),this.card_viewer_container.find("tr.info-upgrades").show(),this.card_viewer_container.find("tr.info-upgrades td.info-data").text(e.slots.join(", ")||"None");break;default:this.card_viewer_container.find(".info-type").text(s),null!=e.faction&&this.card_viewer_container.find(".info-type").append(" &ndash; "+e.faction+" only"),this.card_viewer_container.find("tr.info-ship").hide(),this.card_viewer_container.find("tr.info-skill").hide(),null!=e.attack?(this.card_viewer_container.find("tr.info-attack td.info-data").text(e.attack),this.card_viewer_container.find("tr.info-attack").show()):this.card_viewer_container.find("tr.info-attack").hide(),null!=e.range?(this.card_viewer_container.find("tr.info-range td.info-data").text(e.range),this.card_viewer_container.find("tr.info-range").show()):this.card_viewer_container.find("tr.info-range").hide(),this.card_viewer_container.find("tr.info-agility").hide(),this.card_viewer_container.find("tr.info-hull").hide(),this.card_viewer_container.find("tr.info-shields").hide(),this.card_viewer_container.find("tr.info-actions").hide(),this.card_viewer_container.find("tr.info-upgrades").hide()}return this.card_viewer_container.show(),this.card_viewer_placeholder.hide()},o.prototype.addCardTo=function(t,e){var a;return a=$(document.createElement("OPTION")),a.text(""+e.name+" ("+e.data.points+")"),a.data("name",e.name),a.data("type",e.type),a.data("card",e.data),$(t).append(a)},o}()}).call(this);
//@ sourceMappingURL=browser.min.map