(function(){var t,n,e,i,a=[].indexOf||function(t){for(var n=0,e=this.length;e>n;n++)if(n in this&&this[n]===t)return n;return-1};i="undefined"!=typeof exports&&null!==exports?exports:this,t=["pilots","upgrades","modifications","titles"],n=function(t,n){var e,i;return e=t.name.toLowerCase().replace(/[^a-zA-Z0-9]/g,""),i=n.name.toLowerCase().replace(/[^a-zA-Z0-9]/g,""),i>e?-1:e>i?1:0},e=function(t,e){return t.data.points<e.data.points?-1:e.data.points<t.data.points?1:n(t,e)},String.prototype.capitalize=function(){return this.charAt(0).toUpperCase()+this.slice(1)},i.CardBrowser=function(){function r(t){this.container=$(t.container),this.currently_selected=null,this.language="English",this.prepareData(),this.setupUI(),this.setupHandlers(),this.sort_selector.change()}return r.prototype.setupUI=function(){return this.container.append($.trim('<div class="container-fluid xwing-card-browser">\n    <div class="row-fluid">\n        <div class="span12">\n            <span class="translate sort-cards-by">Sort cards by</span>: <select class="sort-by">\n                <option value="name">Name</option>\n                <option value="source">Source</option>\n                <option value="type-by-points">Type (by Points)</option>\n                <option value="type-by-name" selected="1">Type (by Name)</option>\n            </select>\n        </div>\n    </div>\n    <div class="row-fluid">\n        <div class="span4 card-selector-container">\n\n        </div>\n        <div class="span8">\n            <div class="well card-viewer-placeholder info-well">\n                <p class="translate select-a-card">Select a card from the list at the left.</p>\n            </div>\n            <div class="well card-viewer-container info-well">\n                <span class="info-name"></span>\n                <br />\n                <span class="info-type"></span>\n                <br />\n                <span class="info-sources"></span>\n                <table>\n                    <tbody>\n                        <tr class="info-skill">\n                            <td class="info-header">Skill</td>\n                            <td class="info-data info-skill"></td>\n                        </tr>\n                        <tr class="info-energy">\n                            <td class="info-header"><i class="xwing-miniatures-font xwing-miniatures-font-energy"></i></td>\n                            <td class="info-data info-energy"></td>\n                        </tr>\n                        <tr class="info-attack">\n                            <td class="info-header"><i class="xwing-miniatures-font xwing-miniatures-font-attack"></i></td>\n                            <td class="info-data info-attack"></td>\n                        </tr>\n                        <tr class="info-range">\n                            <td class="info-header">Range</td>\n                            <td class="info-data info-range"></td>\n                        </tr>\n                        <tr class="info-agility">\n                            <td class="info-header"><i class="xwing-miniatures-font xwing-miniatures-font-agility"></i></td>\n                            <td class="info-data info-agility"></td>\n                        </tr>\n                        <tr class="info-hull">\n                            <td class="info-header"><i class="xwing-miniatures-font xwing-miniatures-font-hull"></i></td>\n                            <td class="info-data info-hull"></td>\n                        </tr>\n                        <tr class="info-shields">\n                            <td class="info-header"><i class="xwing-miniatures-font xwing-miniatures-font-shield"></i></td>\n                            <td class="info-data info-shields"></td>\n                        </tr>\n                        <tr class="info-actions">\n                            <td class="info-header">Actions</td>\n                            <td class="info-data"></td>\n                        </tr>\n                        <tr class="info-upgrades">\n                            <td class="info-header">Upgrades</td>\n                            <td class="info-data"></td>\n                        </tr>\n                    </tbody>\n                </table>\n                <p class="info-text" />\n            </div>\n        </div>\n    </div>\n</div>')),this.card_selector_container=$(this.container.find(".xwing-card-browser .card-selector-container")),this.card_viewer_container=$(this.container.find(".xwing-card-browser .card-viewer-container")),this.card_viewer_container.hide(),this.card_viewer_placeholder=$(this.container.find(".xwing-card-browser .card-viewer-placeholder")),this.sort_selector=$(this.container.find("select.sort-by")),this.sort_selector.select2({minimumResultsForSearch:-1})},r.prototype.setupHandlers=function(){return this.sort_selector.change(function(t){return function(){return t.renderList(t.sort_selector.val())}}(this)),$(window).on("xwing:afterLanguageLoad",function(t){return function(n,e,i){return null==i&&(i=$.noop),t.language=e,t.prepareData(),t.renderList(t.sort_selector.val())}}(this))},r.prototype.prepareData=function(){var r,s,o,d,c,l,h,f,u,p,_,g,v,w,y,m,b,x,k,$,C,T,P,E;for(this.all_cards=[],u=0,v=t.length;v>u;u++)h=t[u],this.all_cards=this.all_cards.concat("upgrades"===h?function(){var t,n;t=i[h],n=[];for(o in t)s=t[o],n.push({name:s.name,type:i.translate(this.language,"ui","upgradeHeader",s.slot),data:s,orig_type:s.slot});return n}.call(this):function(){var t,n;t=i[h],n=[];for(o in t)s=t[o],n.push({name:s.name,type:i.translate(this.language,"singular",h),data:s,orig_type:i.translate("English","singular",h)});return n}.call(this));this.types=function(){var t,n,e,a;for(e=["Pilot","Modification","Title"],a=[],t=0,n=e.length;n>t;t++)h=e[t],a.push(i.translate(this.language,"types",h));return a}.call(this),C=i.upgrades;for(o in C)s=C[o],f=i.translate(this.language,"ui","upgradeHeader",s.slot),a.call(this.types,f)<0&&this.types.push(f);for(this.all_cards.sort(n),this.sources=[],T=this.all_cards,p=0,w=T.length;w>p;p++)for(r=T[p],P=r.data.sources,_=0,y=P.length;y>_;_++)l=P[_],a.call(this.sources,l)<0&&this.sources.push(l);for(c=this.types.sort(),d=this.sources.sort(),this.cards_by_type_name={},g=0,m=c.length;m>g;g++)h=c[g],this.cards_by_type_name[h]=function(){var t,n,e,i;for(e=this.all_cards,i=[],n=0,t=e.length;t>n;n++)r=e[n],r.type===h&&i.push(r);return i}.call(this).sort(n);for(this.cards_by_type_points={},k=0,b=c.length;b>k;k++)h=c[k],this.cards_by_type_points[h]=function(){var t,n,e,i;for(e=this.all_cards,i=[],n=0,t=e.length;t>n;n++)r=e[n],r.type===h&&i.push(r);return i}.call(this).sort(e);for(this.cards_by_source={},E=[],$=0,x=d.length;x>$;$++)l=d[$],E.push(this.cards_by_source[l]=function(){var t,n,e,i;for(e=this.all_cards,i=[],n=0,t=e.length;t>n;n++)r=e[n],a.call(r.data.sources,l)>=0&&i.push(r);return i}.call(this).sort(n));return E},r.prototype.renderList=function(t){var n,e,i,a,r,s,o,d,c,l,h,f,u,p,_,g,v,w,y,m,b,x,k,C,T;switch(null==t&&(t="name"),null!=this.card_selector&&this.card_selector.remove(),this.card_selector=$(document.createElement("SELECT")),this.card_selector.addClass("card-selector"),this.card_selector.attr("size",25),this.card_selector_container.append(this.card_selector),t){case"type-by-name":for(y=this.types,r=0,c=y.length;c>r;r++)for(a=y[r],e=$(document.createElement("OPTGROUP")),e.attr("label",a),this.card_selector.append(e),m=this.cards_by_type_name[a],s=0,l=m.length;l>s;s++)n=m[s],this.addCardTo(e,n);break;case"type-by-points":for(b=this.types,o=0,h=b.length;h>o;o++)for(a=b[o],e=$(document.createElement("OPTGROUP")),e.attr("label",a),this.card_selector.append(e),x=this.cards_by_type_points[a],d=0,f=x.length;f>d;d++)n=x[d],this.addCardTo(e,n);break;case"source":for(k=this.sources,g=0,u=k.length;u>g;g++)for(i=k[g],e=$(document.createElement("OPTGROUP")),e.attr("label",i),this.card_selector.append(e),C=this.cards_by_source[i],v=0,p=C.length;p>v;v++)n=C[v],this.addCardTo(e,n);break;default:for(T=this.all_cards,w=0,_=T.length;_>w;w++)n=T[w],this.addCardTo(this.card_selector,n)}return this.card_selector.change(function(t){return function(){return t.renderCard($(t.card_selector.find(":selected")))}}(this))},r.prototype.renderCard=function(t){var n,e,a,r,s,o,d,c,l,h,f,u,p,_,g,v,w,y,m,b,x;switch(a=t.data("name"),c=t.data("type"),e=t.data("card"),r=t.data("orig_type"),this.card_viewer_container.find(".info-name").html(""+(e.unique?"&middot;&nbsp;":"")+a+" ("+e.points+")"+(null!=e.limited?" ("+i.translate(this.language,"ui","limited")+")":"")+(null!=e.epic?" ("+i.translate(this.language,"ui","epic")+")":"")+(i.isReleased(e)?"":" ("+i.translate(this.language,"ui","unreleased")+")")),this.card_viewer_container.find("p.info-text").html(null!=(l=e.text)?l:""),this.card_viewer_container.find(".info-sources").text(function(){var t,n,a,r;for(a=e.sources,r=[],t=0,n=a.length;n>t;t++)d=a[t],r.push(i.translate(this.language,"sources",d));return r}.call(this).sort().join(", ")),r){case"Pilot":s=i.ships[e.ship],this.card_viewer_container.find(".info-type").text(""+e.ship+" Pilot ("+e.faction+")"),this.card_viewer_container.find("tr.info-skill td.info-data").text(e.skill),this.card_viewer_container.find("tr.info-skill").show(),this.card_viewer_container.find("tr.info-attack td.info-data").text(null!=(h=null!=(_=e.ship_override)?_.attack:void 0)?h:s.attack),this.card_viewer_container.find("tr.info-attack").toggle(null!=(null!=(g=e.ship_override)?g.attack:void 0)||null!=s.attack),this.card_viewer_container.find("tr.info-energy td.info-data").text(null!=(v=null!=(w=e.ship_override)?w.energy:void 0)?v:s.energy),this.card_viewer_container.find("tr.info-energy").toggle(null!=(null!=(y=e.ship_override)?y.energy:void 0)||null!=s.energy),this.card_viewer_container.find("tr.info-range").hide(),this.card_viewer_container.find("tr.info-agility td.info-data").text(null!=(m=null!=(b=e.ship_override)?b.agility:void 0)?m:s.agility),this.card_viewer_container.find("tr.info-agility").show(),this.card_viewer_container.find("tr.info-hull td.info-data").text(null!=(x=null!=(f=e.ship_override)?f.hull:void 0)?x:s.hull),this.card_viewer_container.find("tr.info-hull").show(),this.card_viewer_container.find("tr.info-shields td.info-data").text(null!=(u=null!=(p=e.ship_override)?p.shields:void 0)?u:s.shields),this.card_viewer_container.find("tr.info-shields").show(),this.card_viewer_container.find("tr.info-actions td.info-data").text(function(){var t,a,r,s;for(r=i.ships[e.ship].actions,s=[],t=0,a=r.length;a>t;t++)n=r[t],s.push(i.translate(this.language,"action",n));return s}.call(this).join(", ")),this.card_viewer_container.find("tr.info-actions").show(),this.card_viewer_container.find("tr.info-upgrades").show(),this.card_viewer_container.find("tr.info-upgrades td.info-data").text(function(){var t,n,a,r;for(a=e.slots,r=[],t=0,n=a.length;n>t;t++)o=a[t],r.push(i.translate(this.language,"slot",o));return r}.call(this).join(", ")||"None");break;default:this.card_viewer_container.find(".info-type").text(c),null!=e.faction&&this.card_viewer_container.find(".info-type").append(" &ndash; "+e.faction+" only"),this.card_viewer_container.find("tr.info-ship").hide(),this.card_viewer_container.find("tr.info-skill").hide(),null!=e.energy?(this.card_viewer_container.find("tr.info-energy td.info-data").text(e.energy),this.card_viewer_container.find("tr.info-energy").show()):this.card_viewer_container.find("tr.info-energy").hide(),null!=e.attack?(this.card_viewer_container.find("tr.info-attack td.info-data").text(e.attack),this.card_viewer_container.find("tr.info-attack").show()):this.card_viewer_container.find("tr.info-attack").hide(),null!=e.range?(this.card_viewer_container.find("tr.info-range td.info-data").text(e.range),this.card_viewer_container.find("tr.info-range").show()):this.card_viewer_container.find("tr.info-range").hide(),this.card_viewer_container.find("tr.info-agility").hide(),this.card_viewer_container.find("tr.info-hull").hide(),this.card_viewer_container.find("tr.info-shields").hide(),this.card_viewer_container.find("tr.info-actions").hide(),this.card_viewer_container.find("tr.info-upgrades").hide()}return this.card_viewer_container.show(),this.card_viewer_placeholder.hide()},r.prototype.addCardTo=function(t,n){var e;return e=$(document.createElement("OPTION")),e.text(""+n.name+" ("+n.data.points+")"),e.data("name",n.name),e.data("type",n.type),e.data("card",n.data),e.data("orig_type",n.orig_type),$(t).append(e)},r}()}).call(this);
//# sourceMappingURL=browser.min.js
//@ sourceMappingURL=browser.min.map