(function(){var t,n;n="undefined"!=typeof exports&&null!==exports?exports:this,n.fromXWSFaction={rebels:"Rebel Alliance",empire:"Galactic Empire",scum:"Scum and Villainy"},n.toXWSFaction={"Rebel Alliance":"rebels","Galactic Empire":"empire","Scum and Villainy":"scum"},n.toXWSUpgrade={Astromech:"amd",Elite:"ept",Modification:"mod","Salvaged Astromech":"samd"},n.fromXWSUpgrade={amd:"Astromech",astromechdroid:"Astromech",ept:"Elite",elitepilottalent:"Elite",mod:"Modification",samd:"Salvaged Astromech"},t={L:1,M:0,Q:3,H:2},n.XWSManager=function(){function i(t){this.container=$(t.container),this.setupUI(),this.setupHandlers()}return i.prototype.setupUI=function(){return this.container.addClass("hidden-print"),this.container.html($.trim('<div class="row-fluid">\n    <div class="span9">\n        <button class="btn btn-primary from-xws">Import from XWS (beta)</button>\n        <button class="btn btn-primary to-xws">Export to XWS (beta)</button>\n    </div>\n</div>')),this.xws_export_modal=$(document.createElement("DIV")),this.xws_export_modal.addClass("modal hide fade xws-modal hidden-print"),this.container.append(this.xws_export_modal),this.xws_export_modal.append($.trim('<div class="modal-header">\n    <button type="button" class="close hidden-print" data-dismiss="modal" aria-hidden="true">&times;</button>\n    <h3>XWS Export (Beta!)</h3>\n</div>\n<div class="modal-body">\n    <ul class="nav nav-pills">\n        <li><a id="xws-text-tab" href="#xws-text" data-toggle="tab">Text</a></li>\n        <li><a id="xws-qrcode-tab" href="#xws-qrcode" data-toggle="tab">QR Code</a></li>\n    </ul>\n    <div class="tab-content">\n        <div class="tab-pane" id="xws-text">\n            Copy and paste this into an XWS-compliant application to transfer your list.\n            <i>(This is in beta, and the <a href="https://gist.github.com/voidstate/288965581669a2a68073">spec</a> is still being defined, so it may not work!)</i>\n            <div class="container-fluid">\n                <textarea class="xws-content"></textarea>\n            </div>\n        </div>\n        <div class="tab-pane" id="xws-qrcode">\n            Below is a <b>zlib-compressed</b> QR Code of XWS.  <i>This is still very experimental!</i>\n            <div id="xws-qrcode-container"></div>\n        </div>\n    </div>\n</div>\n<div class="modal-footer hidden-print">\n    <button class="btn" data-dismiss="modal" aria-hidden="true">Close</button>\n</div>')),this.xws_import_modal=$(document.createElement("DIV")),this.xws_import_modal.addClass("modal hide fade xws-modal hidden-print"),this.container.append(this.xws_import_modal),this.xws_import_modal.append($.trim('<div class="modal-header">\n    <button type="button" class="close hidden-print" data-dismiss="modal" aria-hidden="true">&times;</button>\n    <h3>XWS Import (Beta!)</h3>\n</div>\n<div class="modal-body">\n    Paste XWS here to load a list exported from another application.\n    <i>(This is in beta, and the <a href="https://gist.github.com/voidstate/288965581669a2a68073">spec</a> is still being defined, so it may not work!)</i>\n    <div class="container-fluid">\n        <textarea class="xws-content" placeholder="Paste XWS here..."></textarea>\n    </div>\n</div>\n<div class="modal-footer hidden-print">\n    <span class="xws-import-status"></span>&nbsp;\n    <button class="btn btn-primary import-xws">Import It!</button>\n    <button class="btn" data-dismiss="modal" aria-hidden="true">Close</button>\n</div>'))},i.prototype.setupHandlers=function(){return this.from_xws_button=this.container.find("button.from-xws"),this.from_xws_button.click(function(t){return function(n){return n.preventDefault(),t.xws_import_modal.modal("show")}}(this)),this.to_xws_button=this.container.find("button.to-xws"),this.to_xws_button.click(function(i){return function(e){return e.preventDefault(),$(window).trigger("xwing:pingActiveBuilder",function(e){var a,o;return a=$(i.xws_export_modal.find(".xws-content")),a.attr("readonly"),o=JSON.stringify(e.toXWS()),a.val(o),$("#xws-qrcode-container").text(""),$("#xws-qrcode-container").qrcode({text:n.pako.deflate(o,{to:"string",level:9}),correctLevel:t.L}),i.xws_export_modal.modal("show"),$("#xws-text-tab").tab("show"),a.select(),a.focus()})}}(this)),this.load_xws_button=$(this.xws_import_modal.find("button.import-xws")),this.load_xws_button.click(function(t){return function(i){var e;return i.preventDefault(),e=$(t.xws_import_modal.find(".xws-import-status")),e.text("Loading..."),function(e){var a;try{a=JSON.parse(t.xws_import_modal.find(".xws-content").val())}catch(o){return i=o,void e.text("Invalid JSON")}return function(i){return $(window).trigger("xwing:activateBuilder",[n.fromXWSFaction[i.faction],function(n){return n.current_squad.dirty&&null!=n.backend?(t.xws_import_modal.modal("hide"),n.backend.warnUnsaved(n,function(){return n.loadFromXWS(i,function(n){return n.success?void 0:(t.xws_import_modal.modal("show"),e.text(n.error))})})):n.loadFromXWS(i,function(n){return n.success?t.xws_import_modal.modal("hide"):e.text(n.error)})}])}(a)}(e)}}(this))},i}()}).call(this);
//# sourceMappingURL=xws.min.js
//@ sourceMappingURL=xws.min.map