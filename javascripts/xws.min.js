(function(){var t;t="undefined"!=typeof exports&&null!==exports?exports:this,t.fromXWSFaction={rebels:"Rebel Alliance",empire:"Galactic Empire",scum:"Scum and Villainy"},t.toXWSFaction={"Rebel Alliance":"rebels","Galactic Empire":"empire","Scum and Villainy":"scum"},t.toXWSUpgrade={Astromech:"amd",Elite:"ept",Modification:"mod","Salvaged Astromech":"samd"},t.fromXWSUpgrade={amd:"Astromech",astromechdroid:"Astromech",ept:"Elite",elitepilottalent:"Elite",mod:"Modification",samd:"Salvaged Astromech"},t.XWSManager=function(){function n(t){this.container=$(t.container),this.setupUI(),this.setupHandlers()}return n.prototype.setupUI=function(){return this.container.addClass("hidden-print"),this.container.html($.trim('<div class="row-fluid">\n    <div class="span9">\n        <button class="btn btn-primary from-xws">Import from XWS (beta)</button>\n        <button class="btn btn-primary to-xws">Export to XWS (beta)</button>\n    </div>\n</div>')),this.xws_export_modal=$(document.createElement("DIV")),this.xws_export_modal.addClass("modal hide fade xws-modal hidden-print"),this.container.append(this.xws_export_modal),this.xws_export_modal.append($.trim('<div class="modal-header">\n    <button type="button" class="close hidden-print" data-dismiss="modal" aria-hidden="true">&times;</button>\n    <h3>XWS Export (Beta!)</h3>\n</div>\n<div class="modal-body">\n    <ul class="nav nav-pills">\n        <li><a id="xws-text-tab" href="#xws-text" data-toggle="tab">Text</a></li>\n        <li><a id="xws-qrcode-tab" href="#xws-qrcode" data-toggle="tab">QR Code</a></li>\n    </ul>\n    <div class="tab-content">\n        <div class="tab-pane" id="xws-text">\n            Copy and paste this into an XWS-compliant application to transfer your list.\n            <i>(This is in beta, and the <a href="https://gist.github.com/voidstate/288965581669a2a68073">spec</a> is still being defined, so it may not work!)</i>\n            <div class="container-fluid">\n                <textarea class="xws-content"></textarea>\n            </div>\n        </div>\n        <div class="tab-pane" id="xws-qrcode">\n            Below is a <b>zlib-compressed</b> QR Code of XWS.  <i>This is still very experimental!</i>\n            <div id="xws-qrcode-container"></div>\n        </div>\n    </div>\n</div>\n<div class="modal-footer hidden-print">\n    <button class="btn" data-dismiss="modal" aria-hidden="true">Close</button>\n</div>')),this.xws_import_modal=$(document.createElement("DIV")),this.xws_import_modal.addClass("modal hide fade xws-modal hidden-print"),this.container.append(this.xws_import_modal),this.xws_import_modal.append($.trim('<div class="modal-header">\n    <button type="button" class="close hidden-print" data-dismiss="modal" aria-hidden="true">&times;</button>\n    <h3>XWS Import (Beta!)</h3>\n</div>\n<div class="modal-body">\n    Paste XWS here to load a list exported from another application.\n    <i>(This is in beta, and the <a href="https://gist.github.com/voidstate/288965581669a2a68073">spec</a> is still being defined, so it may not work!)</i>\n    <div class="container-fluid">\n        <textarea class="xws-content" placeholder="Paste XWS here..."></textarea>\n    </div>\n</div>\n<div class="modal-footer hidden-print">\n    <span class="xws-import-status"></span>&nbsp;\n    <button class="btn btn-primary import-xws">Import It!</button>\n    <button class="btn" data-dismiss="modal" aria-hidden="true">Close</button>\n</div>'))},n.prototype.setupHandlers=function(){return this.from_xws_button=this.container.find("button.from-xws"),this.from_xws_button.click(function(t){return function(n){return n.preventDefault(),t.xws_import_modal.modal("show")}}(this)),this.to_xws_button=this.container.find("button.to-xws"),this.to_xws_button.click(function(n){return function(i){return i.preventDefault(),$(window).trigger("xwing:pingActiveBuilder",function(i){var e,a;return e=$(n.xws_export_modal.find(".xws-content")),e.attr("readonly"),a=JSON.stringify(i.toXWS()),e.val(a),$("#xws-qrcode-container").text(""),$("#xws-qrcode-container").qrcode(t.pako.deflate(a,{to:"string",level:9})),n.xws_export_modal.modal("show"),$("#xws-text-tab").tab("show"),e.select(),e.focus()})}}(this)),this.load_xws_button=$(this.xws_import_modal.find("button.import-xws")),this.load_xws_button.click(function(n){return function(i){var e;return i.preventDefault(),e=$(n.xws_import_modal.find(".xws-import-status")),e.text("Loading..."),function(e){var a;try{a=JSON.parse(n.xws_import_modal.find(".xws-content").val())}catch(o){return i=o,void e.text("Invalid JSON")}return function(i){return $(window).trigger("xwing:activateBuilder",[t.fromXWSFaction[i.faction],function(t){return t.current_squad.dirty&&null!=t.backend?(n.xws_import_modal.modal("hide"),t.backend.warnUnsaved(t,function(){return t.loadFromXWS(i,function(t){return t.success?void 0:(n.xws_import_modal.modal("show"),e.text(t.error))})})):t.loadFromXWS(i,function(t){return t.success?n.xws_import_modal.modal("hide"):e.text(t.error)})}])}(a)}(e)}}(this))},n}()}).call(this);
//# sourceMappingURL=xws.min.js
//@ sourceMappingURL=xws.min.map